# ===================================
# ENVIRONMENT CONFIGURATION TEMPLATE
# ===================================
# Copy this file to create environment-specific configs:
#   - .env.development  (local development)
#   - .env.production   (GCP Cloud Run production)
#   - .env              (active config - gitignored)
#
# Quick start: cp .env.development .env

# ===================================
# Application Configuration
# ===================================
NODE_ENV=development
PORT=3000
LOG_LEVEL=info

# ===================================
# Database Configuration
# ===================================
# Local development (Docker Compose):
DATABASE_URL=postgresql://galacash:galacash123@localhost:5433/galacash_db

# Production (Cloud SQL via Unix socket):
# DATABASE_URL=postgresql://USER:PASSWORD@localhost:5432/DB?host=/cloudsql/PROJECT:REGION:INSTANCE
# Example: postgresql://appuser:SECURE_PASS@localhost:5432/galacash?host=/cloudsql/my-project:asia-southeast2:galacash-sql
# IMPORTANT: Use Secret Manager in production

# ===================================
# Redis Configuration
# ===================================
# Local development:
REDIS_URL=redis://localhost:6379

# Production (Memorystore via VPC connector):
# REDIS_URL=redis://10.x.x.x:6379
# Get IP: gcloud redis instances describe galacash-redis --region=REGION --format='value(host)'

# ===================================
# JWT Configuration
# ===================================
# Generate secure keys for production:
#   openssl rand -base64 64
# CRITICAL: Use Secret Manager in production
JWT_SECRET=your-super-secret-jwt-access-token-key-change-this-in-production
JWT_REFRESH_SECRET=your-super-secret-jwt-refresh-token-key-change-this-in-production

# ===================================
# GCP Cloud Storage Configuration
# ===================================
# For file uploads (avatars, payment proofs, attachments)
# Leave empty to disable uploads (development)
GCP_PROJECT_ID=
GCP_BUCKET_NAME=galacash-bucket

# Local dev: path to service account JSON
# Cloud Run: uses Application Default Credentials (leave empty)
GOOGLE_APPLICATION_CREDENTIALS=

# ===================================
# Scheduled Jobs Configuration
# ===================================
# Cron expression for monthly bill generation
# Format: "minute hour day month dayOfWeek"
# Default: "0 0 1 * *" (midnight on 1st of each month)
# Production: "0 2 1 * *" (2 AM WIB on 1st)
BILL_GENERATION_SCHEDULE=0 0 1 * *

# Bill amounts (in IDR)
# KAS_KELAS_AMOUNT: Monthly class dues amount (default: 15000)
# Note: Admin fee (BIAYA_ADMIN) has been removed - set to 0 in code
KAS_KELAS_AMOUNT=15000

# ===================================
# CORS Configuration
# ===================================
# Development: allow all origins
CORS_ORIGIN=*

# Production: restrict to frontend domain
# CORS_ORIGIN=https://galacash.example.com
# Use Secret Manager for this value

# ===================================
# Setup Instructions
# ===================================
# Development:
#   1. cp .env.development .env
#   2. Start services: docker-compose up -d
#   3. Run migrations: pnpm prisma migrate dev
#   4. Start dev server: pnpm dev
#
# Production (GCP Cloud Run):
#   1. Create secrets in Secret Manager:
#      echo -n "YOUR_JWT_SECRET" | gcloud secrets create JWT_SECRET --data-file=-
#      echo -n "YOUR_DB_URL" | gcloud secrets create DATABASE_URL --data-file=-
#   2. Deploy with secrets mounted:
#      gcloud run deploy galacash-api \
#        --image=REGION-docker.pkg.dev/PROJECT/REPO/galacash:latest \
#        --set-secrets="JWT_SECRET=JWT_SECRET:latest,DATABASE_URL=DATABASE_URL:latest" \
#        --add-cloudsql-instances="PROJECT:REGION:INSTANCE" \
#        --vpc-connector="galacash-vpc-connector"
#   3. See .env.production for full deployment guide
#
# Security Notes:
#   - Never commit .env files (except .env.example)
#   - Rotate secrets regularly
#   - Use IAM roles, not service account keys in production
#   - Enable Cloud Armor for DDoS protection
